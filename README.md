# Automated Business Insights Agent

This project features an autonomous AI agent that empowers non-technical users to perform complex data analysis on business datasets using only natural language commands. The agent acts as an automated data analyst, translating plain English questions into executable Python (`pandas`) code to find and present insights.

## Core Features

-   **Code Generation**: The agent dynamically writes and executes Python `pandas` code to answer user queries, automating a traditionally manual data analysis workflow.
-   **Schema Awareness**: Before starting, the agent is provided with the head and info of the dataset, grounding its reasoning process and significantly reducing code hallucinations.
-   **Self-Correction Loop**: The agent is engineered to be resilient. If it writes code that results in a Python error, it analyzes the traceback, understands its mistake, and automatically writes corrected code to retry the operation.
-   **Interactive CLI**: A user-friendly command-line interface allows for easy interaction with the agent.

## Project Structure

```
/automated-business-analyst/
|
â”œâ”€â”€ ðŸ“‚ data/
|   â””â”€â”€ sales_data_sample.csv  # Sample data for analysis
|
â”œâ”€â”€ ðŸ“„ .env.example             # Example environment file
â”œâ”€â”€ ðŸ“„ .gitignore
â”œâ”€â”€ ðŸ“„ agent.py                 # Core agent logic, prompt engineering, and self-correction loop
â”œâ”€â”€ ðŸ“„ main.py                  # Entry point and interactive command-line interface
â”œâ”€â”€ ðŸ“„ README.md
â”œâ”€â”€ ðŸ“„ requirements.txt         # Project dependencies
â””â”€â”€ ðŸ“„ tools.py                 # Defines the Python REPL tool for the agent
```

## Setup & Installation

1.  **Clone the repository:**
    ```bash
    git clone https://github.com/your-username/automated-business-analyst.git
    cd automated-business-analyst
    ```

2.  **Create a virtual environment and activate it:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows, use `venv\Scripts\activate`
    ```

3.  **Install the required dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

4.  **Set up your environment variables:**
    -   Rename the `.env.example` file to `.env`.
    -   Open the `.env` file and add your OpenAI API key:
        ```
        OPENAI_API_KEY="your_api_key_here"
        ```

## How to Run

Execute the `main.py` script from your terminal:

```bash
python main.py
```

The application will start, and you can begin asking questions about the provided sales data.

### Example Questions

-   "What was the total revenue for all products?"
-   "Which product category had the highest total revenue?"
-   "What were the top 3 best-selling products by units sold?"
-   "Calculate the average unit price for each product category."

## Example Interaction

```
$ python main.py
Welcome to the Automated Business Analyst!
You can ask questions about the sales data. Type 'exit' to quit.

Ask a question about the data: Which product category generated the most revenue?
Thinking... (Turn 1/7)
THOUGHT: The user wants to find the product category with the highest total revenue. I need to group the DataFrame by 'Product_Category' and sum the 'Total_Revenue' for each category. Then I can find the category with the maximum sum.
ACTION (Executing Code):
---
print(df.groupby('Product_Category')['Total_Revenue'].sum().idxmax())
---
OBSERVATION:
---
Code executed successfully. Output:
Electronics
---
Thinking... (Turn 2/7)
THOUGHT: I have found the product category that generated the most revenue, which is 'Electronics'. I now need to find the actual revenue amount for this category to provide a complete answer. I will group by category again, sum the revenue, and then select the value for 'Electronics'.
ACTION (Executing Code):
---
print(df.groupby('Product_Category')['Total_Revenue'].sum().max())
---
OBSERVATION:
---
Code executed successfully. Output:
20750
---

Final Answer:
The product category that generated the most revenue was Electronics, with a total revenue of $20,750.
```

> **Security Warning**: This project uses Python's `exec()` function to run code generated by an LLM. This is for demonstration purposes in a controlled environment. Never expose this functionality to untrusted users on the internet without proper, robust sandboxing (e.g., running the code execution in a separate, isolated Docker container with strict resource limits).